import{u as R}from"./D49-a2Gj.js";import{u as L}from"./DZjlKxoF.js";import{u as M}from"./DQej5_ef.js";import{a as V}from"./BGFP1kuB.js";import{s as w}from"./B2WlxZpZ.js";import{b as k}from"./BaD6kt_k.js";import{u as B,a as C}from"./D8ABh0bF.js";import{V as P}from"./Cq4psN1U.js";import{d as D,S as s,z as l,T as x,W as p,D as F,H as N,K as A,E as z,C as H,Y as I,L as O}from"./DIRjBTfL.js";const Q=D({__name:"VLoadMore",props:{kind:{},searchTerm:{},relatedTo:{},searchType:{},isFetching:{type:Boolean}},emits:["load-more"],setup(f,{emit:h}){const o=f,g=h,r=s(null),v=M(),{t:n}=R({useScope:"global"}),c=B(),a=C(),{$sendCustomEvent:i}=L(),{currentPage:S}=w(c),u=l(()=>{let e=a.strategy==="default"?"search":"collection";const m=a.collectionValue??"null";return{searchType:o.searchType,query:o.searchTerm,resultPage:S.value||1,kind:e,collectionType:m,collectionValue:a.collectionValue??"null"}}),b=l(()=>c.canLoadMore),t=s(!1),y=async()=>{o.isFetching||(t.value=!1,i("LOAD_MORE_RESULTS",u.value),g("load-more"))},E=()=>{i("REACH_RESULT_END",u.value)},T=l(()=>o.isFetching?n("browsePage.loading"):n("browsePage.load")),d=s(null);x(()=>{d.value=document.getElementById("main-page")});const _=k(r,{scrollTarget:d});return p(v,()=>{t.value=!1}),p(_,e=>{if(e){if(t.value)return;E(),t.value=!0}}),(e,m)=>(F(),N("div",{ref_key:"loadMoreSectionRef",ref:r,class:"w-full"},[A(z(P,{class:"label-bold lg:description-bold h-16 w-full lg:h-18",variant:"filled-gray",size:"disabled",disabled:e.isFetching,"data-testid":"load-more",onClick:y},{default:H(()=>[I(O(T.value),1)]),_:1},8,["disabled"]),[[V,b.value]])],512))}});export{Q as _};
