import{u as x}from"./D49-a2Gj.js";import{z as r,S as w,W as N,d as k,D as o,A as S,C as M,I as g,Q as P,L as v,M as b,T as j,p as z,H as p,N as U,O as Y,E as T,Y as V,J,K,U as D}from"./DIRjBTfL.js";import{u as Q}from"./DQej5_ef.js";import{f as B}from"./Xs_VBmP5.js";import{d as X,a as O}from"./D8ABh0bF.js";import{_ as Z}from"./Cf7ZGiFl.js";import{I as ee}from"./DQZ7AVLk.js";import{g as ae,V as te}from"./CBV_TNzK.js";import{_ as se}from"./uju1JVgF.js";import{u as ie}from"./Co_6C_Y0.js";import{u as le}from"./DZjlKxoF.js";import{h as ne,w as oe}from"./BaD6kt_k.js";import{a as re}from"./BllLUjK0.js";import{_ as ce}from"./WxAe2_--.js";import{V as G}from"./Cq4psN1U.js";import{V as q}from"./BQ1v-1nn.js";import{_ as ue}from"./DQs5-Eiu.js";import{a as de}from"./BGFP1kuB.js";import{u as me}from"./U05EHdjt.js";import{_ as pe}from"./BO06l8fi.js";import{u as fe}from"./n5kG8ZGm.js";import{_ as he}from"./B9OEfXZU.js";const ge=({title:l,thumbnail:t,isSensitive:a})=>{const s={meta:[]},e=[];return l&&e.push({key:"og:title",property:"og:title",content:l}),t&&!a&&e.push({key:"og:image",property:"og:image",content:t}),s.meta=e,s},ia=l=>{var h;const{t}=x({useScope:"global"}),a=()=>l.value?{genericTitle:`${t(`mediaDetails.reuse.${l.value.frontendMediaType}`)}`,sensitiveTitle:`${t(`sensitiveContent.title.${l.value.frontendMediaType}`)}`}:{genericTitle:"",sensitiveTitle:""},s=r(()=>{var m;return((m=l.value)==null?void 0:m.isSensitive)??!1}),e=()=>l.value?s.value?a().sensitiveTitle:l.value.title??a().genericTitle:"",c=()=>`${e()} | Openverse`,d=w(c()),i=ge({title:e(),thumbnail:(h=l.value)==null?void 0:h.thumbnail,isSensitive:s.value});return N(l,()=>{d.value=c()}),{pageTitle:d,detailPageMeta:i}},la=k({__name:"VRelatedMedia",props:{mediaType:{},relatedTo:{}},setup(l){const t=l,a=X(),s=Q(),e=r(()=>{const f=a.media??[];return{type:t.mediaType,items:f}});N(s,async f=>{const $=B(f==null?void 0:f.params.id);$&&$!==a.mainMediaId&&await a.fetchMedia(t.mediaType,$)},{immediate:!0});const c=r(()=>a.fetchState.isFetching),d=r(()=>e.value.items.length>0||c.value),i=r(()=>B(s==null?void 0:s.query.q)??""),{t:h}=x({useScope:"global"}),m=r(()=>{const f=t.mediaType==="audio"?"audioDetails.relatedAudios":"imageDetails.relatedImages";return h(f)});return(f,$)=>d.value?(o(),S(Z,{key:0,results:e.value,"is-fetching":c.value,"collection-label":m.value,kind:"related","related-to":f.relatedTo,"search-term":i.value,"aria-label":m.value},{header:M(()=>[g("h2",{id:"related-heading",class:P(["heading-6 mb-6",e.value.type==="image"?"md:heading-5":"lg:heading-6"])},v(m.value),3)]),_:1},8,["results","is-fetching","collection-label","related-to","search-term","aria-label"])):b("",!0)}}),ve={class:"-my-1.5px"},_e=3,E=k({__name:"VCollapsibleTagSection",props:{tags:{},mediaType:{}},setup(l){const t=l,a=w(),s=O(),{$sendCustomEvent:e}=le(),c=n=>s.getCollectionPath({type:t.mediaType,collectionParams:{collection:"tag",tag:n}}),d=r(()=>Array.from(new Set(t.tags.map(n=>n.name)))),i=w(),{localeProperties:h}=x({useScope:"global"}),m=r(()=>h.value.dir);function f(n,u){return m.value==="rtl"?n.offsetLeft<u.offsetLeft:n.offsetLeft>u.offsetLeft}function $(n){const u=Array.from(n.children);if(!u.length)return 0;let y=0;for(let C=0;C<u.length;C++){const L=u[C],R=L.previousElementSibling;if(R?f(R,L)&&y++:y++,y===_e+1)return C}return u.length}const F=r(()=>i.value&&_.value==="show"?d.value.slice(0,i.value):d.value),I=r(()=>i.value&&i.value<d.value.length);j(()=>{a.value&&(i.value=$(a.value))});const _=w("show"),H=()=>{_.value=_.value==="show"?"hide":"show",e("TOGGLE_TAG_EXPANSION",{toState:_.value==="show"?"collapsed":"expanded"}),_.value==="hide"&&i.value&&z(()=>{var u;if(!i.value)return;const n=(u=a.value)==null?void 0:u.children.item(i.value);re(n==null?void 0:n.querySelector("a"))})},W=r(()=>I.value?_.value==="show"?"max-h-[7.6875rem]":"mah-h-none":"max-h-none"),A=w();return ne(a,n=>{A.value=n[0].contentRect.width}),oe(A,(n,u)=>{if(!a.value)return;u&&n&&n>u&&(i.value=d.value.length),z(()=>{a.value&&(i.value=$(a.value))})},{debounce:300}),(n,u)=>(o(),p("div",ve,[g("ul",{ref_key:"tagsContainerRef",ref:a,class:P(["flex flex-wrap gap-3 overflow-y-hidden p-1.5px",W.value])},[(o(!0),p(U,null,Y(F.value,y=>(o(),p("li",{key:y},[T(ce,{href:c(y)},{default:M(()=>[V(v(y),1)]),_:2},1032,["href"])]))),128))],2),I.value?(o(),S(G,{key:0,size:"small",variant:"transparent-tx","has-icon-end":"",class:"label-bold -ms-2 mt-4 hover:underline","aria-expanded":_.value==="show"?"false":"true",onClick:H},{default:M(()=>[V(v(n.$t(_.value==="show"?"mediaDetails.tags.showMore":"mediaDetails.tags.showLess")),1),T(q,{name:"caret-down",size:4,class:P({"-scale-y-100 transform":_.value==="hide"})},null,8,["class"])]),_:1},8,["aria-expanded"])):b("",!0)]))}}),ye={class:"flex flex-col gap-6 sm:gap-8"},Te={key:0},be={key:0,class:"label-regular mb-2"},$e={key:1,class:"sr-only"},Se={key:1},ke={class:"label-regular mb-2 flex gap-2"},we=k({__name:"VMediaTags",props:{tags:{},mediaType:{},provider:{}},setup(l){const t=l,a=r(()=>{const i=[],h=[];for(const m of t.tags)m.unstable__provider&&m.unstable__provider!==t.provider?i.push(m):h.push(m);return{generated:i,source:h}}),s=r(()=>a.value.source.length>0),e=r(()=>a.value.generated.length>0),c=ie(),d=r(()=>c("/tags"));return(i,h)=>(o(),p("div",ye,[s.value?(o(),p("div",Te,[e.value?(o(),p("h3",be,v(i.$t("mediaDetails.tags.source.heading")),1)):(o(),p("h3",$e,v(i.$t("mediaDetails.tags.title")),1)),T(E,{"media-type":i.mediaType,tags:a.value.source},null,8,["media-type","tags"])])):b("",!0),e.value?(o(),p("div",Se,[g("div",ke,[g("h3",null,v(i.$t("mediaDetails.tags.generated.heading")),1),T(ue,{href:d.value},{default:M(()=>[V(v(i.$t("mediaDetails.tags.generated.pageTitle")),1)]),_:1},8,["href"])]),T(E,{"media-type":i.mediaType,tags:a.value.generated},null,8,["media-type","tags"])])):b("",!0)]))}}),Me={class:"flex flex-col gap-y-6 md:gap-y-8"},Ce={class:"flex flex-row items-center justify-between"},xe={class:"heading-6 md:heading-5"},De={class:"flex flex-col items-start gap-6 md:flex-row"},Pe={class:"flex flex-col gap-6 md:gap-8"},Ve={class:"flex w-full flex-grow flex-col items-start gap-6 md:flex-row"},Ie={key:0},na=k({__name:"VMediaDetails",props:{media:{}},setup(l){const t=l,a=x({useScope:"global"}),s=r(()=>{if(!t.media)return null;let e=t.media.frontendMediaType===ee?{width:t.media.width,height:t.media.height,type:t.media.filetype}:{};return ae(t.media,a,e)});return(e,c)=>(o(),p("section",Me,[g("header",Ce,[g("h2",xe,v(e.$t(`mediaDetails.${e.media.frontendMediaType}Info`)),1),T(se,{media:e.media},null,8,["media"])]),g("div",De,[J(e.$slots,"thumbnail"),g("div",Pe,[g("div",Ve,[e.media.description?(o(),p("p",Ie,v(e.media.description),1)):b("",!0),s.value?(o(),S(te,{key:1,metadata:s.value},null,8,["metadata"])):b("",!0)]),T(we,{tags:e.media.tags,"media-type":e.media.frontendMediaType,provider:e.media.provider},null,8,["tags","media-type","provider"])])])]))}}),Ae={class:"hidden md:block"},Le=k({__name:"VHideButton",emits:["click"],setup(l){const t=fe(),a=r(()=>t.isBreakpoint("md"));return(s,e)=>(o(),p("div",null,[a.value?(o(),S(G,{key:0,variant:"transparent-gray",class:"label-bold",size:"small","has-icon-end":"",onClick:e[0]||(e[0]=c=>s.$emit("click"))},{default:M(()=>[g("span",Ae,v(s.$t("sensitiveContent.singleResult.hide")),1),T(q,{name:"eye-closed"})]),_:1})):(o(),S(he,{key:1,variant:"transparent-gray","icon-props":{name:"eye-closed"},size:"small",label:s.$t("sensitiveContent.singleResult.hide"),onClick:e[1]||(e[1]=c=>s.$emit("click"))},null,8,["label"]))]))}}),Re={class:"flex w-full justify-between px-4 pb-4 md:px-8"},oa=k({__name:"VSingleResultControls",props:{media:{}},setup(l){const t=l,a=O(),s=r(()=>a.backToSearchPath),{hide:e,canBeHidden:c}=me(t.media);return(d,i)=>K((o(),p("div",Re,[s.value?(o(),S(pe,{key:0,id:d.media.id,href:s.value},null,8,["id","href"])):b("",!0),D(c)?(o(),S(Le,{key:1,class:"ml-auto",onClick:D(e)},null,8,["onClick"])):b("",!0)],512)),[[de,D(c)||s.value]])}});export{oa as _,na as a,la as b,ia as u};
